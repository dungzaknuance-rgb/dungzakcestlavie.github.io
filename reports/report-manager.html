<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DUNGZAK CESTLAVIE â€” Report Manager</title>
<style>
  body {
    background: #0a0a0a;
    color: #e6e6e6;
    font-family: 'Pretendard', sans-serif;
    padding: 40px;
    line-height: 1.7;
  }
  h1 {
    font-size: 28px;
    color: #ffd86b;
    text-align: center;
    margin-bottom: 30px;
  }
  .upload-section {
    border: 1px solid #444;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 30px;
    background: #111;
  }
  label { display: block; margin: 10px 0 5px; color: #aaa; }
  input, textarea {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #333;
    background: #1a1a1a;
    color: #fff;
    font-size: 15px;
  }
  button {
    margin-top: 15px;
    background: #ffd86b;
    border: none;
    border-radius: 6px;
    padding: 10px 16px;
    cursor: pointer;
    color: #111;
    font-weight: bold;
  }
  .report-list {
    margin-top: 40px;
  }
  .report-item {
    border-bottom: 1px solid #333;
    padding: 15px 0;
  }
  .pdf-btn {
    background: #00c9a7;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 6px 12px;
    margin-left: 10px;
    cursor: pointer;
  }
</style>
</head>
<body>
  <h1>ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE â€” ë¯¸í•™ ë³´ê³ ì„œ ê´€ë¦¬ì</h1>

  <div class="upload-section">
    <h3>â• ìƒˆ ë¯¸í•™ ë³´ê³ ì„œ ì—…ë¡œë“œ</h3>
    <label>Report ID</label>
    <input id="reportId" placeholder="ì˜ˆ: dcar01">
    <label>Title (ì˜ë¬¸)</label>
    <input id="titleEn" placeholder="On Light, Memory, and Being">
    <label>Title (í•œê¸€)</label>
    <input id="titleKo" placeholder="ë¹›, ê¸°ì–µ, ì¡´ì¬ì— ê´€í•˜ì—¬">
    <label>Abstract</label>
    <textarea id="abstract" rows="4" placeholder="ìš”ì•½ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
    <label>Year</label>
    <input id="year" type="number" value="2025">
    <button onclick="saveReport()">Save Report</button>
  </div>

  <div class="report-list">
    <h3>ğŸ“š ë“±ë¡ëœ ë¯¸í•™ ë³´ê³ ì„œ ëª©ë¡</h3>
    <div id="reportList"></div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
let reports = [];

async function loadReports() {
  const res = await fetch('../data/reports.json');
  const data = await res.json();
  reports = data.reports || [];
  renderReports();
}

function renderReports() {
  const list = document.getElementById('reportList');
  list.innerHTML = '';
  reports.forEach(r => {
    const div = document.createElement('div');
    div.className = 'report-item';
    div.innerHTML = `
      <strong>${r.id}</strong> Â· ${r.title_en}<br>
      ${r.title_ko}<br>
      <button class="pdf-btn" onclick="downloadPDF('${r.id}')">ğŸ“„ PDF ë‹¤ìš´ë¡œë“œ</button>
    `;
    list.appendChild(div);
  });
}

async function saveReport() {
  const newReport = {
    id: document.getElementById('reportId').value.trim(),
    title_en: document.getElementById('titleEn').value.trim(),
    title_ko: document.getElementById('titleKo').value.trim(),
    abstract: document.getElementById('abstract').value.trim(),
    year: document.getElementById('year').value.trim()
  };
  reports.push(newReport);
  alert('âœ… ë³´ê³ ì„œê°€ ì„ì‹œë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. JSON íŒŒì¼ì— ë³‘í•©ì€ GitHubì—ì„œ ìˆ˜ë™ ì—…ë°ì´íŠ¸ í•„ìš”í•©ë‹ˆë‹¤.');
  renderReports();
}

function downloadPDF(reportId) {
  const { jsPDF } = window.jspdf;
  const report = reports.find(r => r.id === reportId);
  if (!report) return alert('ë³´ê³ ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  const doc = new jsPDF({ unit: 'pt', format: 'a4' });
  doc.setFontSize(18);
  doc.text(`DUNGZAK CESTLAVIE Aesthetic Report`, 40, 60);
  doc.setFontSize(14);
  doc.text(`ID: ${report.id}`, 40, 100);
  doc.text(`Title (EN): ${report.title_en}`, 40, 120);
  doc.text(`Title (KO): ${report.title_ko}`, 40, 140);
  doc.text(`Year: ${report.year}`, 40, 160);
  doc.setFontSize(12);
  doc.text(`Abstract:`, 40, 200);
  doc.text(report.abstract, 40, 220, { maxWidth: 500 });
  doc.save(`${report.id}.pdf`);
}
loadReports();
</script>
</body>
</html>
